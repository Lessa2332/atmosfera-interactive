<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ–º–∞ 2: –•–º–∞—Ä–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        .lesson-card { position: relative; padding: 40px; }
        .nav-buttons { position: absolute; top: 20px; left: 20px; gap: 20px; z-index: 10; }
        .section { margin: 50px 0; background: rgba(255,255,255,0.05); padding: 30px; border-radius: 28px; border: 2px solid #00FFFF; box-shadow: 0 0 30px rgba(0,255,255,0.4); }
        .cloud-simulation { height: clamp(300px, 60vh, 500px); background: linear-gradient(to bottom, #0F172A 0%, #1E293B 100%); border: 2px solid #00FFFF; box-shadow: 0 0 40px #00FFFF; }
        .cloud { background: rgba(255,255,255,0.2); box-shadow: 0 0 30px #00FFFF; backdrop-filter: blur(4px); }
        .quiz-question { text-align: center; margin: 30px 0; }
        .quiz-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .quiz-option { padding: 20px; background: rgba(255,255,255,0.1); border-radius: 24px; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
        .quiz-option:hover { transform: scale(1.05); box-shadow: 0 0 30px #00FFFF; }
        .quiz-option.correct { border: 2px solid #39FF14; box-shadow: 0 0 40px #39FF14; }
        .quiz-option.wrong { border: 2px solid #F44336; box-shadow: 0 0 40px #F44336; }
        .rain-animation { height: clamp(300px, 50vh, 400px); position: relative; background: linear-gradient(to bottom, #0F172A, #1E293B); overflow: hidden; border-radius: 28px; border: 2px solid #00FFFF; }
        .rain-drop { position: absolute; width: 2px; height: 20px; background: #00FFFF; opacity: 0.8; animation: fall linear infinite; }
        @keyframes fall { 0% { transform: translateY(-100%); } 100% { transform: translateY(100vh); } }
        .complete-btn { display: none; margin: 40px auto; padding: 20px 50px; font-size: 24px; background: linear-gradient(45deg, #39FF14, #32CD32); box-shadow: 0 0 40px #39FF14; }
    </style>
</head>
<body>
    <div class="lesson-card">
        <div class="nav-buttons">
            <a href="index.html" class="btn-primary">üè† –ì–æ–ª–æ–≤–Ω–∞</a>
            <button class="btn-primary" onclick="logout()">–í–∏–π—Ç–∏</button>
        </div>

        <h1 style="text-align:center; text-shadow:0 0 30px #00FFFF;"><i class="fas fa-cloud"></i> –¢–µ–º–∞ 2: –Ø–∫ —É—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —Ö–º–∞—Ä–∏</h1>

        <!-- 1. –°–∏–º—É–ª—è—Ç–æ—Ä -->
        <div class="section">
            <h2 style="text-align:center; color:#00FFFF;">1. –°–∏–º—É–ª—è—Ç–æ—Ä —É—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ö–º–∞—Ä</h2>
            <div class="cloud-simulation" id="cloudSimulation"><div class="stars" id="stars"></div></div>
            <div class="controls-panel">
                <div class="slider-container">
                    <div class="slider-label"><span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</span><span id="tempValue">20¬∞C</span></div>
                    <input type="range" id="temperature" min="-10" max="40" value="20">
                </div>
                <div class="slider-container">
                    <div class="slider-label"><span>–í–æ–ª–æ–≥—ñ—Å—Ç—å</span><span id="humidityValue">50%</span></div>
                    <input type="range" id="humidity" min="0" max="100" value="50">
                </div>
                <button id="formClouds" class="btn-primary">–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ö–º–∞—Ä–∏</button>
                <button id="completeSim" class="btn-primary complete-btn">–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Å–∏–º—É–ª—è—Ç–æ—Ä (+20 –±–∞–ª—ñ–≤)</button>
            </div>
        </div>

        <!-- 2. –í—ñ–∫—Ç–æ—Ä–∏–Ω–∞ -->
        <div class="section">
            <h2 style="text-align:center; color:#00FFFF;">2. –í—ñ–∫—Ç–æ—Ä–∏–Ω–∞: –í–≥–∞–¥–∞–π —Ç–∏–ø —Ö–º–∞—Ä–∏</h2>
            <!-- –ü—Ä–∏–∫–ª–∞–¥ –ø–∏—Ç–∞–Ω–Ω—è (–¥–æ–¥–∞–π –±—ñ–ª—å—à–µ) -->
            <div class="quiz-question">
                <img src="URL_–ó–û–ë–†–ê–ñ–ï–ù–ù–Ø_–ö–£–ß–ï–í–ò–•_–•–ú–ê–†" alt="–•–º–∞—Ä–∏" style="max-width:100%; border-radius:20px; box-shadow:0 0 30px #00FFFF;">
                <p>–Ø–∫–∏–π —Ü–µ —Ç–∏–ø —Ö–º–∞—Ä?</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="correct">–ö—É—á–µ–≤—ñ</div>
                    <div class="quiz-option">–®–∞—Ä—É–≤–∞—Ç—ñ</div>
                    <div class="quiz-option">–ü–µ—Ä–∏—Å—Ç—ñ</div>
                </div>
            </div>
            <button id="completeQuiz" class="btn-primary complete-btn">–ó–∞–≤–µ—Ä—à–∏—Ç–∏ –≤—ñ–∫—Ç–æ—Ä–∏–Ω—É (+20 –±–∞–ª—ñ–≤)</button>
        </div>

        <!-- 3. –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–æ—â—É + –ø–∏—Ç–∞–Ω–Ω—è -->
        <div class="section">
            <h2 style="text-align:center; color:#00FFFF;">3. –Ø–∫ —É—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –¥–æ—â?</h2>
            <div class="rain-animation" id="rainAnimation"></div>
            <p style="text-align:center; margin:20px 0;">–û–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å:</p>
            <div class="quiz-options">
                <div class="quiz-option" data-answer="correct">–ö—Ä–∞–ø–ª—ñ –≤–æ–¥–∏ –≤ —Ö–º–∞—Ä—ñ —Å—Ç–∞—é—Ç—å –≤–∞–∂–∫–∏–º–∏ —ñ –ø–∞–¥–∞—é—Ç—å</div>
                <div class="quiz-option">–•–º–∞—Ä–∏ —Ç–∞–Ω—É—Ç—å</div>
                <div class="quiz-option">–í—ñ—Ç–µ—Ä –≤–∏–¥—É–≤–∞—î –≤–æ–¥—É</div>
            </div>
            <button id="completeRain" class="btn-primary complete-btn">–ó–∞–≤–µ—Ä—à–∏—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—é (+20 –±–∞–ª—ñ–≤)</button>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —É—Ä–æ–∫—É -->
        <div style="text-align:center;">
            <button id="completeLesson" class="btn-primary" style="padding:20px 50px; font-size:24px;">–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —É—Ä–æ–∫ (+60 –±–∞–ª—ñ–≤)! üåü</button>
        </div>
    </div>

    <script>
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbx1ok9gz_71vNK7NyDXlGrhkw4QcaDwBsggtJ_7eqE_XRZw_9PLiqPFn-SnpWx9yh3kFA/exec';

        let completed = { sim: false, quiz: false, rain: false };

        async function addPoints(points) {
            const user = JSON.parse(localStorage.getItem('atmosphereUser'));
            if (!user) return return;
            const data = { name: user.name, class: user.class, theme: "–•–º–∞—Ä–∏", points: points };
            await fetch(SHEET_URL, { method: 'POST', body: JSON.stringify(data) });
        }

        async function completeSection(section, points) {
            if (completed[section]) return;
            completed[section] = true;
            await addPoints(points);
            alert(`+${points} –±–∞–ª—ñ–≤!`);
            checkAllCompleted();
        }

        function checkAllCompleted() {
            if (completed.sim && completed.quiz && completed.rain) {
                document.getElementById('completeLesson').style.display = 'block';
            }
        }

        document.getElementById('completeSim').onclick = () => completeSection('sim', 20);
        document.getElementById('completeQuiz').onclick = () => completeSection('quiz', 20);
        document.getElementById('completeRain').onclick = () => completeSection('rain', 20);

        document.getElementById('completeLesson').onclick = async () => {
            await addPoints(60); // –∑–∞–≥–∞–ª–æ–º
            alert('–£—Ä–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! +60 –±–∞–ª—ñ–≤ –∑–∞ –•–º–∞—Ä–∏!');
            window.location.href = 'index.html';
        };

        // –°–∏–º—É–ª—è—Ç–æ—Ä —Ö–º–∞—Ä (—Ç–≤—ñ–π –∫–æ–¥ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó)
        // + –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∞ –ª–æ–≥—ñ–∫–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ)
        // + –∞–Ω—ñ–º–∞—Ü—ñ—è –¥–æ—â—É (–≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫—Ä–∞–ø–µ–ª—å)
        // + –∑—ñ—Ä–∫–∏ –Ω–∞ –Ω–µ–±–æ
    </script>
</body>
</html>
