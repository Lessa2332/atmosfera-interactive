<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–≤—ñ—Ç—Ä—è ‚Äî 12 –±–∞–ª—ñ–≤ –ù–£–®</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;font-family:system-ui,-apple-system,Segoe UI,sans-serif;
  background:linear-gradient(135deg,#e0f2fe,#fef9c3);
  padding:16px;color:#1f2937
}
h1,h2{text-align:center}
section{
  max-width:1100px;margin:20px auto;background:#fff;
  border-radius:18px;padding:clamp(16px,3vw,28px);
  box-shadow:0 10px 30px rgba(0,0,0,.12)
}
button{
  padding:12px 18px;border-radius:12px;border:none;
  background:#0284c7;color:#fff;font-size:1rem;cursor:pointer
}
button:hover{background:#0369a1}
.read{text-align:center;font-weight:700;margin-top:10px}

/* SCENE */
.scene{
  position:relative;height:320px;border-radius:16px;
  background:linear-gradient(#7dd3fc 60%,#22c55e 40%);
  overflow:hidden;touch-action:none
}
.sun{
  position:absolute;width:70px;height:70px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%,#fff59d,#f59e0b);
  box-shadow:0 0 30px #f59e0b;cursor:grab
}
.thermo{
  position:absolute;right:12px;bottom:12px;
  width:28px;height:200px;border:2px solid #334155;
  border-radius:14px;background:#e5e7eb;overflow:hidden
}
.mercury{
  position:absolute;bottom:0;width:100%;
  background:linear-gradient(#ef4444,#22d3ee);
  height:40%;transition:.3s
}

/* CONTROLS */
.controls{display:grid;gap:12px}
@media(min-width:768px){.controls{grid-template-columns:1fr 1fr}}

.score{
  text-align:center;font-size:1.3rem;
  background:#dcfce7;padding:14px;border-radius:14px
}
table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{padding:8px;text-align:center;border-bottom:1px solid #e5e7eb}
</style>
</head>

<body>

<h1>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–≤—ñ—Ç—Ä—è (12 –±–∞–ª—ñ–≤)</h1>

<!-- INTERACTIVE -->
<section>
<h2>üåû –°–æ–Ω—Ü–µ —ñ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (4 –±–∞–ª–∏)</h2>
<p style="text-align:center">–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ —Å–æ–Ω—Ü–µ –ø–æ –Ω–µ–±—É</p>

<div class="scene" id="scene">
  <div class="sun" id="sun"></div>
  <div class="thermo"><div class="mercury" id="mercury"></div></div>
</div>

<div class="read" id="tempText">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 20¬∞C</div>
</section>

<!-- GAME -->
<section>
<h2>üéÆ –ü–æ—Ä–∏ —Ä–æ–∫—É (4 –±–∞–ª–∏)</h2>

<div class="controls">
  <select id="season">
    <option value="winter">‚ùÑÔ∏è –ó–∏–º–∞</option>
    <option value="spring">üå± –í–µ—Å–Ω–∞</option>
    <option value="summer">‚òÄÔ∏è –õ—ñ—Ç–æ</option>
    <option value="autumn">üçÇ –û—Å—ñ–Ω—å</option>
  </select>
  <input type="range" id="range" min="-20" max="35" value="10">
</div>

<div class="read" id="rangeVal">10¬∞C</div>
<button onclick="checkSeason()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
<div class="read" id="seasonMsg"></div>
</section>

<!-- QUIZ -->
<section>
<h2>üìù –¢–µ—Å—Ç (4 –±–∞–ª–∏)</h2>

<label><input type="radio" name="q" value="0"> –ó–µ–º–ª—è –±–ª–∏–∂—á–µ –¥–æ –°–æ–Ω—Ü—è</label>
<label><input type="radio" name="q" value="1"> –ü—Ä–æ–º–µ–Ω—ñ –ø–∞–¥–∞—é—Ç—å –ø—ñ–¥ –±—ñ–ª—å—à–∏–º –∫—É—Ç–æ–º</label>
<label><input type="radio" name="q" value="0"> –°–æ–Ω—Ü–µ –±—ñ–ª—å—à–∏—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤</label>
<label><input type="radio" name="q" value="0"> –ú—ñ—Å—è—Ü—å –Ω–∞–≥—Ä—ñ–≤–∞—î –ø–æ–≤—ñ—Ç—Ä—è</label>

<button onclick="checkQuiz()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
<div class="read" id="quizMsg"></div>
</section>

<section class="score" id="finalScore">–†–µ–∑—É–ª—å—Ç–∞—Ç: 0 / 12</section>

<section style="text-align:center">
<button onclick="sendResult()">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ç–∞ –∑–±–µ—Ä–µ–≥—Ç–∏</button>
</section>

<section>
<h2>üèÜ –õ—ñ–¥–µ—Ä–±–æ—Ä–¥ –∫–ª–∞—Å—É</h2>
<button onclick="loadLeaderboard()">üîÑ –û–Ω–æ–≤–∏—Ç–∏</button>
<table>
<thead>
<tr><th>#</th><th>–Ü–º º—è</th><th>–ö–ª–∞—Å</th><th>–ë–∞–ª–∏</th></tr>
</thead>
<tbody id="lbBody"></tbody>
</table>
</section>

<script>
/* ===== CONFIG ===== */
const SHEET_URL =
"https://script.google.com/macros/s/AKfycbwQTDZFGpxje9jVN2FpUy-nmPJNf0CcCvSslOsQambXS7Qw-fT1WP0LimOcyrdd19ioFQ/exec";

/* ===== SCORE ===== */
let score=0;
const done={sun:false,season:false,quiz:false};

function addPoints(k){
  if(done[k])return;
  done[k]=true; score+=4; updateScore();
}
function updateScore(){
  finalScore.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${score} / 12`;
}

/* ===== SUN ===== */
sun.style.left="50%"; sun.style.top="20%";
let drag=false;
sun.addEventListener("pointerdown",()=>drag=true);
document.addEventListener("pointerup",()=>drag=false);

scene.addEventListener("pointermove",e=>{
  if(!drag)return;
  const r=scene.getBoundingClientRect();
  let x=((e.clientX-r.left)/r.width)*100;
  let y=((e.clientY-r.top)/r.height)*100;
  x=Math.max(5,Math.min(90,x));
  y=Math.max(5,Math.min(80,y));
  sun.style.left=x+"%";
  sun.style.top=y+"%";

  const temp=Math.round(30-y*0.25);
  tempText.textContent=`–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: ${temp}¬∞C`;
  mercury.style.height=Math.min(100,temp+20)+"%";

  addPoints("sun");
});

/* ===== SEASONS ===== */
const ranges={
  winter:[-10,0], spring:[8,15],
  summer:[22,30], autumn:[10,18]
};
range.oninput=()=>rangeVal.textContent=range.value+"¬∞C";

function checkSeason(){
  if(done.season)return;
  const t=+range.value;
  const [a,b]=ranges[season.value];
  if(t>=a && t<=b){
    addPoints("season");
    seasonMsg.textContent="‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! +4";
  } else seasonMsg.textContent="‚ùå –°–ø—Ä–æ–±—É–π —â–µ";
}

/* ===== QUIZ ===== */
function checkQuiz(){
  if(done.quiz)return;
  const a=document.querySelector('input[name="q"]:checked');
  if(!a){quizMsg.textContent="–û–±–µ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å";return;}
  if(a.value==="1"){
    addPoints("quiz");
    quizMsg.textContent="‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! +4";
  } else quizMsg.textContent="‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ";
}

/* ===== LEADERBOARD ===== */
function saveToLeaderboard(d){
  const b=JSON.parse(localStorage.getItem("classLeaderboard")||"[]");
  const e=b.find(u=>u.name===d.name && u.class===d.class);
  if(e)e.score=Math.max(e.score,d.score); else b.push(d);
  localStorage.setItem("classLeaderboard",JSON.stringify(b));
}
function loadLeaderboard(){
  const b=JSON.parse(localStorage.getItem("classLeaderboard")||"[]")
    .sort((a,b)=>b.score-a.score);
  lbBody.innerHTML="";
  b.forEach((u,i)=>{
    lbBody.innerHTML+=
    `<tr><td>${i+1}</td><td>${u.name}</td><td>${u.class}</td><td>${u.score}</td></tr>`;
  });
}

/* ===== SEND ===== */
async function sendResult(){
  if(score!==12){alert("–í–∏–∫–æ–Ω–∞–π —É—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è");return;}
  const user=JSON.parse(
    localStorage.getItem("atmosphereUser")
    ||'{"name":"–£—á–µ–Ω—å","class":"6-–ê"}'
  );
  const payload={name:user.name,class:user.class,theme:"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞",score:12};

  try{
    await fetch(SHEET_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(payload)
    });
    saveToLeaderboard(payload);
    loadLeaderboard();
    alert("‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ Google Sheets!");
  }catch{
    alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è");
  }
}
</script>

</body>
</html>
